<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBay Listing Master Tool (Ver 2.0)</title>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background-color: #f4f6f8; color: #333; }
        h1 { text-align: center; color: #005fbc; margin-bottom: 30px; }
        
        .tab-menu { display: flex; border-bottom: 2px solid #ddd; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 15px; cursor: pointer; text-align: center; font-weight: bold; font-size: 16px; color: #666; background: #eee; border: none; border-radius: 8px 8px 0 0; margin-right: 2px; transition: 0.3s; }
        .tab-btn:hover { background: #e0e0e0; }
        .tab-btn.active { background: #005fbc; color: white; }
        
        .tab-content { display: none; background: white; padding: 30px; border-radius: 0 0 8px 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .tab-content.active { display: block; }

        textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 13px; resize: vertical; }
        button { background-color: #005fbc; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 15px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { background-color: #004c99; }
        .copy-btn { background: #666; font-size: 12px; padding: 5px 10px; margin-left: 10px; }

        .upload-box { border: 2px dashed #ccc; padding: 30px; text-align: center; border-radius: 8px; margin-bottom: 20px; cursor: pointer; transition: 0.3s; background: #fafafa; }
        .upload-box:hover { border-color: #005fbc; background-color: #f0f7ff; }
        #ocrStatus { margin: 10px 0; font-weight: bold; color: #005fbc; text-align: center; min-height: 20px; }
        .progress-bar { width: 100%; background-color: #e0e0e0; border-radius: 4px; overflow: hidden; height: 10px; margin-bottom: 20px; display: none; }
        .progress-fill { height: 100%; background-color: #4caf50; width: 0%; transition: width 0.3s; }

        .assembler-container { display: flex; gap: 20px; }
        .left-panel { flex: 1; }
        .right-panel { flex: 1.5; border-left: 1px solid #eee; padding-left: 20px; }
        .result-group { margin-bottom: 20px; border: 1px solid #eee; padding: 15px; border-radius: 8px; background: #fafafa; }
        .result-label { font-weight: bold; display: block; margin-bottom: 5px; color: #555; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f0f7ff; width: 30%; }
        
        @media (max-width: 768px) { .assembler-container { flex-direction: column; } .right-panel { border-left: none; padding-left: 0; border-top: 1px solid #eee; padding-top: 20px; } }
    </style>
</head>
<body>

<h1>eBay Listing Master Tool</h1>

<div class="tab-menu">
    <button class="tab-btn active" onclick="openTab('step1')">Step 1. ì´ë¯¸ì§€ í…ìŠ¤íŠ¸ ì¶”ì¶œ (OCR)</button>
    <button class="tab-btn" onclick="openTab('step2')">Step 2. ë¦¬ìŠ¤íŒ… HTML ìƒì„± (JSON)</button>
</div>

<div id="step1" class="tab-content active">
    <h2 style="margin-top:0;">ğŸ“· ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸ ë½‘ê¸°</h2>
    <div class="upload-box" onclick="document.getElementById('fileInput').click()">
        <p>ğŸ“ í´ë¦­í•´ì„œ <strong>ìƒì„¸í˜ì´ì§€ ì´ë¯¸ì§€</strong> ì—…ë¡œë“œ</p>
        <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="processImage(this)">
    </div>
    <div id="ocrStatus">ëŒ€ê¸° ì¤‘...</div>
    <div class="progress-bar" id="progressBar"><div class="progress-fill" id="progressFill"></div></div>
    <textarea id="resultText" style="height: 300px;" placeholder="ì¶”ì¶œëœ í…ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤..."></textarea>
    <div style="margin-top: 10px; text-align: right;"><button onclick="copyText('resultText')">ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬</button></div>
</div>

<div id="step2" class="tab-content">
    <h2 style="margin-top:0;">ğŸ› ï¸ JSONìœ¼ë¡œ HTML ì¡°ë¦½í•˜ê¸°</h2>
    <div class="assembler-container">
        <div class="left-panel">
            <h4>ğŸ‘‡ JSON ë°ì´í„° ë¶™ì—¬ë„£ê¸°</h4>
            <textarea id="jsonInput" style="height: 400px;" placeholder='{"titles": {...}, "item_specifics": {...}}'></textarea>
            <br><br>
            <button onclick="generateListing()" style="width:100%;">ğŸš€ ë¦¬ìŠ¤íŒ… ìƒì„±í•˜ê¸°</button>
        </div>
        <div class="right-panel">
            <div id="outputArea" style="display:none;">
                <div class="result-group">
                    <span class="result-label">Title Option A <button class="copy-btn" onclick="copyText('titleA')">ë³µì‚¬</button></span>
                    <input type="text" id="titleA" style="width:100%; padding:8px;" readonly>
                </div>
                <div class="result-group">
                    <span class="result-label">Title Option B <button class="copy-btn" onclick="copyText('titleB')">ë³µì‚¬</button></span>
                    <input type="text" id="titleB" style="width:100%; padding:8px;" readonly>
                </div>
                <div class="result-group">
                    <span class="result-label">Item Specifics (ì…ë ¥ ìˆœì„œëŒ€ë¡œ)</span>
                    <table id="specsTable"></table>
                </div>
                <div class="result-group">
                    <span class="result-label">ğŸ”¥ Final HTML Code <button class="copy-btn" onclick="copyText('finalHtml')">ì½”ë“œ ë³µì‚¬</button></span>
                    <textarea id="finalHtml" style="height: 200px;"></textarea>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function openTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function copyText(elementId) {
        const copyText = document.getElementById(elementId);
        copyText.select();
        document.execCommand("copy");
    }

    // OCR Logic
    async function processImage(input) {
        if (!input.files || !input.files[0]) return;
        const file = input.files[0];
        const status = document.getElementById('ocrStatus');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        const resultArea = document.getElementById('resultText');
        
        resultArea.value = "";
        progressBar.style.display = 'block';
        progressFill.style.width = '0%';
        status.innerText = "ì´ë¯¸ì§€ ë¡œë”© ì¤‘...";

        const img = new Image();
        img.src = URL.createObjectURL(file);
        img.onload = async function() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const sliceHeight = 1500; 
            const totalSlices = Math.ceil(img.height / sliceHeight);
            let fullText = "";

            status.innerText = `ì´ ${totalSlices}ê°œ êµ¬ê°„ ë¶„ì„ ì‹œì‘...`;
            const worker = await Tesseract.createWorker('kor'); 

            for (let i = 0; i < totalSlices; i++) {
                const y = i * sliceHeight;
                const h = Math.min(sliceHeight, img.height - y);
                canvas.width = img.width;
                canvas.height = h;
                ctx.drawImage(img, 0, y, img.width, h, 0, 0, img.width, h);
                const { data: { text } } = await worker.recognize(canvas);
                fullText += `--- [Section ${i + 1}] ---\n${text}\n\n`;
                const progress = ((i + 1) / totalSlices) * 100;
                progressFill.style.width = `${progress}%`;
                resultArea.value = fullText;
            }
            await worker.terminate();
            status.innerText = "âœ… í…ìŠ¤íŠ¸ ì¶”ì¶œ ì™„ë£Œ!";
            progressBar.style.display = 'none';
        };
    }

    // Assembler Logic (HTML Ver 2.0 Template)
    const htmlTemplateBefore = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        .product-container { max-width: 1000px; margin: 0 auto; font-family: 'Arial', sans-serif; background: #fff; border: 1px solid #e0e0e0; }
        .header { background: linear-gradient(135deg, #F8FAFD 0%, #f8f9fa 100%); padding: 10px 30px; display: flex; align-items: center; border-bottom: 1px solid #e9ecef; }
        .brand-name { font-size: 28px; font-weight: bold; color: #343a40 !important; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
        .tab-container { background: #f8f9fa; border-bottom: 3px solid #4A90E2; }
        .tab-nav { display: flex; overflow-x: auto; white-space: nowrap; }
        .tab-input { display: none; }
        .tab-label { padding: 12px 18px; cursor: pointer; font-size: 13px; font-weight: 600; color: #666; border: 2px solid #ddd; border-bottom: 3px solid transparent; border-radius: 8px 8px 0 0; transition: all 0.3s ease; display: block; text-align: center; background: #f8f9fa; margin-right: 2px; }
        .tab-input:checked + .tab-label { color: #4A90E2; border-bottom-color: #4A90E2; background: white; border-color: #4A90E2; }
        .tab-content { position: relative; }
        .tab-pane { display: none; padding: 30px; min-height: 400px; }
        #tab-details:checked ~ .tab-content .tab-pane[data-tab="item-details"] { display: block; }
        #tab-shipping:checked ~ .tab-content .tab-pane[data-tab="shipping"] { display: block; }
        #tab-customs:checked ~ .tab-content .tab-pane[data-tab="customs"] { display: block; }
        #tab-returns:checked ~ .tab-content .tab-pane[data-tab="returns"] { display: block; }
        #tab-about:checked ~ .tab-content .tab-pane[data-tab="about"] { display: block; }
        .tab-pane h3 { color: #333; margin-bottom: 20px; font-size: 24px; border-bottom: 2px solid #4A90E2; padding-bottom: 10px; }
        .tab-pane h4 { color: #0066cc; margin-bottom: 10px; font-size: 18px; margin-top: 20px; }
        .tab-pane p, .tab-pane ul { line-height: 1.8; color: #555; margin-bottom: 15px; }
        .tab-pane ul { margin-left: 20px; }
        .shipping-info { background: #e8f4fd; border: 1px solid #b3d9ff; border-radius: 8px; padding: 20px; margin-bottom: 20px; }
        @media (max-width: 768px) { .header { flex-direction: column; text-align: center; } .tab-nav { flex-wrap: wrap; } .tab-label { flex: 1; font-size: 11px; } }
    </style>
</head>
<body>
    <div class="product-container">
        <div class="header"><div class="brand-name">K-Family Life</div></div>
        <input type="radio" id="tab-details" name="tabs" class="tab-input" checked>
        <input type="radio" id="tab-shipping" name="tabs" class="tab-input">
        <input type="radio" id="tab-customs" name="tabs" class="tab-input">
        <input type="radio" id="tab-returns" name="tabs" class="tab-input">
        <input type="radio" id="tab-about" name="tabs" class="tab-input">
        <div class="tab-container">
            <div class="tab-nav">
                <label for="tab-details" class="tab-label">Item<br>Details</label>
                <label for="tab-shipping" class="tab-label">International<br>Shipping</label>
                <label for="tab-customs" class="tab-label">Customs &<br>Duties</label>
                <label for="tab-returns" class="tab-label">Refunds/<br>Returns</label>
                <label for="tab-about" class="tab-label">About<br>Us</label>
            </div>
        </div>
        <div class="tab-content">
            <div class="tab-pane" data-tab="item-details">
                <h3>ğŸ“‹ Item Details</h3>`;

    const htmlTemplateAfter = `            </div>
            <div class="tab-pane" data-tab="shipping">
                <h3>ğŸšš International Shipping</h3>
                <div class="shipping-info">
                    <h4>ğŸ“¦ Shipping Methods</h4>
                    <p>â€¢ <strong>Standard International</strong><br>7-14 business days<br>Free Shipping</p>
                    <p>â€¢ <strong>Expedited International</strong><br>3-7 business days<br>Extra shipping fee applies</p>
                </div>
                <div class="shipping-info">
                    <h4>ğŸŒ Shipping Coverage</h4>
                    <p>We ship worldwide to most countries including US, Canada, UK, Germany, France, Australia, Japan, etc.</p>
                </div>
                <p><strong>Note:</strong> Delivery times may vary depending on your location and local customs processing.</p>
            </div>
            <div class="tab-pane" data-tab="customs">
                <h3>ğŸ›ƒ Customs & Duties</h3>
                <div class="shipping-info">
                    <h4>ğŸ‡ºğŸ‡¸ For Buyers in the United States</h4>
                    <p>â€¢ <strong>No Extra Fees:</strong> Duties/Taxes included (DDP).</p>
                </div>
                <div class="shipping-info">
                    <h4>ğŸŒ For Buyers Outside the United States</h4>
                    <p>â€¢ <strong>Buyer's Responsibility:</strong> Duties, taxes, and charges are NOT included.</p>
                </div>
            </div>
            <div class="tab-pane" data-tab="returns">
                <h3>â†©ï¸ Refunds & Returns</h3>
                <div class="shipping-info">
                    <h4>ğŸ”„ Return Policy</h4>
                    <p>â€¢ 30-day return period from delivery date.</p>
                    <p>â€¢ Items must be in original condition.</p>
                </div>
            </div>
            <div class="tab-pane" data-tab="about">
                <h3>ğŸ¢ About Us</h3>
                <p>We are a trusted Korean seller specializing in high-quality products. Authentic products only.</p>
            </div>
        </div>
    </div>
</body>
</html>`;

    function generateListing() {
        const inputStr = document.getElementById('jsonInput').value;
        if (!inputStr) { alert("JSON ë°ì´í„°ë¥¼ ë„£ì–´ì£¼ì„¸ìš”!"); return; }

        try {
            const data = JSON.parse(inputStr);
            
            // 1. Titles
            document.getElementById('titleA').value = data.titles.option_a;
            document.getElementById('titleB').value = data.titles.option_b;

            // 2. Item Specifics (Table) - Gemsê°€ ì¤€ ìˆœì„œ ê·¸ëŒ€ë¡œ ë Œë”ë§
            const specsTable = document.getElementById('specsTable');
            let tableHtml = "";
            let specsListHtml = "<ul>"; 

            // JSON ê°ì²´ì˜ í‚¤ ìˆœì„œë¥¼ ë³´ì¥í•˜ë©° ìˆœíšŒ (ES6ë¶€í„°ëŠ” ì‚½ì… ìˆœì„œ ë³´ì¥ë¨)
            for (const key in data.item_specifics) {
                if (data.item_specifics.hasOwnProperty(key)) {
                    const value = data.item_specifics[key];
                    tableHtml += `<tr><th>${key}</th><td>${value}</td></tr>`;
                    specsListHtml += `<li><strong>${key}:</strong> ${value}</li>`;
                }
            }
            specsListHtml += "</ul>";
            specsTable.innerHTML = tableHtml;

            // 3. Assemble HTML Body
            let descHtml = "";
            const productName = data.item_specifics["Product Name"] || "Product Details";
            
            descHtml += `<div style="margin-bottom: 30px;">
                <h2 style="color: #333; font-size: 22px; margin-bottom: 15px;">${productName}</h2>`;
            
            // Description Points
            if (data.description_points) {
                descHtml += `<div class="shipping-info" style="background: #fff8f8; border-color: #ffcccc;">
                    <h4 style="color: #d9534f; margin-top:0;">ğŸ”¥ Key Benefits</h4>
                    <ul>`;
                data.description_points.forEach(point => {
                    descHtml += `<li>${point}</li>`;
                });
                descHtml += `</ul></div>`;
            }

            // Specs
            descHtml += `<h4>âš™ï¸ Specifications</h4>`;
            descHtml += specsListHtml;

            // Caution
            if (data.caution) {
                descHtml += `<h4>âš ï¸ Caution</h4><ul style="color: #d9534f;">`;
                data.caution.forEach(item => {
                    descHtml += `<li>${item}</li>`;
                });
                descHtml += `</ul>`;
            }
            descHtml += `</div>`;

            // 4. Final Merge
            const finalCode = htmlTemplateBefore + descHtml + htmlTemplateAfter;
            document.getElementById('finalHtml').value = finalCode;
            document.getElementById('outputArea').style.display = 'block';

        } catch (e) {
            alert("JSON í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.\nì˜¤ë¥˜ë‚´ìš©: " + e.message);
        }
    }
</script>

</body>
</html>
