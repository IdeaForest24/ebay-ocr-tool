<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBay ë¦¬ìŠ¤íŒ…ìš© í…ìŠ¤íŠ¸ ì¶”ì¶œê¸° (Web Ver.)</title>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f4f6f8; }
        h1 { color: #333; text-align: center; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        .upload-box { border: 2px dashed #ccc; padding: 30px; text-align: center; border-radius: 8px; margin-bottom: 20px; cursor: pointer; transition: 0.3s; }
        .upload-box:hover { border-color: #005fbc; background-color: #f0f7ff; }
        
        textarea { width: 100%; height: 300px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; resize: vertical; font-size: 14px; line-height: 1.6; }
        
        button { background-color: #005fbc; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-size: 16px; cursor: pointer; width: 100%; margin-top: 10px; }
        button:hover { background-color: #004c99; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        #status { margin: 15px 0; font-weight: bold; color: #005fbc; text-align: center; min-height: 24px; }
        .progress-bar { width: 100%; background-color: #e0e0e0; border-radius: 4px; overflow: hidden; height: 10px; margin-bottom: 20px; display: none; }
        .progress-fill { height: 100%; background-color: #4caf50; width: 0%; transition: width 0.3s; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“„ ìƒì„¸í˜ì´ì§€ í…ìŠ¤íŠ¸ ì¶”ì¶œê¸°</h1>
    <p style="text-align: center; color: #666; margin-bottom: 20px;">
        ê¸´ ì´ë¯¸ì§€ë¥¼ ë„£ìœ¼ë©´ ìë™ìœ¼ë¡œ ì˜ë¼ì„œ í…ìŠ¤íŠ¸ë§Œ ë½‘ì•„ì¤ë‹ˆë‹¤.<br>
        (ê²°ê³¼ë¥¼ ë³µì‚¬í•´ì„œ ë¦¬ìŠ¤íŒ… Gemsì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!)
    </p>

    <div class="upload-box" onclick="document.getElementById('fileInput').click()">
        <p>ğŸ“· ì—¬ê¸°ë¥¼ í´ë¦­í•´ì„œ <strong>ê¸´ ìƒì„¸í˜ì´ì§€ ì´ë¯¸ì§€</strong>ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
        <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="processImage(this)">
    </div>

    <div id="status">ëŒ€ê¸° ì¤‘...</div>
    <div class="progress-bar" id="progressBar"><div class="progress-fill" id="progressFill"></div></div>

    <textarea id="resultText" placeholder="ì¶”ì¶œëœ í…ìŠ¤íŠ¸ê°€ ì—¬ê¸°ì— ë‚˜íƒ€ë‚©ë‹ˆë‹¤..."></textarea>
    <button onclick="copyText()">ğŸ“‹ í…ìŠ¤íŠ¸ ë³µì‚¬í•˜ê¸°</button>
</div>

<script>
    async function processImage(input) {
        if (!input.files || !input.files[0]) return;
        
        const file = input.files[0];
        const status = document.getElementById('status');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        const resultArea = document.getElementById('resultText');
        
        // ì´ˆê¸°í™”
        resultArea.value = "";
        progressBar.style.display = 'block';
        progressFill.style.width = '0%';
        status.innerText = "ì´ë¯¸ì§€ ë¡œë”© ì¤‘...";

        // ì´ë¯¸ì§€ ë¡œë“œ
        const img = new Image();
        img.src = URL.createObjectURL(file);
        
        img.onload = async function() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            const sliceHeight = 1500; // ìë¥¼ ë†’ì´ (í”½ì…€)
            const totalSlices = Math.ceil(img.height / sliceHeight);
            let fullText = "";

            status.innerText = `ì´ ${totalSlices}ê°œ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë¶„ì„ì„ ì‹œì‘í•©ë‹ˆë‹¤...`;

            // Tesseract ì›Œì»¤ ìƒì„±
            const worker = await Tesseract.createWorker('kor+eng'); // í•œêµ­ì–´ ì–¸ì–´íŒ© ë¡œë“œ

            for (let i = 0; i < totalSlices; i++) {
                // ìº”ë²„ìŠ¤ì— ì¡°ê° ê·¸ë¦¬ê¸°
                const y = i * sliceHeight;
                const h = Math.min(sliceHeight, img.height - y);
                
                canvas.width = img.width;
                canvas.height = h;
                ctx.drawImage(img, 0, y, img.width, h, 0, 0, img.width, h);

                // OCR ìˆ˜í–‰
                status.innerText = `[${i + 1}/${totalSlices}] ë¶„ì„ ì¤‘... (ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”)`;
                const { data: { text } } = await worker.recognize(canvas);
                
                fullText += `--- [Section ${i + 1}] ---\n${text}\n\n`;
                
                // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                const progress = ((i + 1) / totalSlices) * 100;
                progressFill.style.width = `${progress}%`;
                
                // ì¤‘ê°„ ê²°ê³¼ ë³´ì—¬ì£¼ê¸°
                resultArea.value = fullText;
                resultArea.scrollTop = resultArea.scrollHeight;
            }

            await worker.terminate();
            status.innerText = "âœ… ëª¨ë“  í…ìŠ¤íŠ¸ ì¶”ì¶œ ì™„ë£Œ!";
            progressBar.style.display = 'none';
        };
    }

    function copyText() {
        const copyText = document.getElementById("resultText");
        copyText.select();
        document.execCommand("copy");
        alert("í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! Gemsì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.");
    }
</script>

</body>
</html>
