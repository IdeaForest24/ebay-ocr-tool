<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBay Listing Assistant v2.0</title>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="header">
    <h1>eBay Listing Assistant</h1>
    <button id="settingsBtn" title="설정">⚙️</button>
</div>

<!-- Step 1: 텍스트 추출 -->
<div id="step1" class="step-section">
    <div class="step1-title-row">
        <h2>Step 1. 텍스트 추출</h2>
    </div>
    <div style="text-align: right; margin-bottom: 10px;">
        <button id="uploadBtn" onclick="document.getElementById('fileInput').click()">📁 이미지 업로드</button>
        <input type="file" id="fileInput" accept="image/*" multiple style="display: none;" onchange="processImages(this)">
    </div>
    <div class="step1-container">
        <div class="step1-left">
            <div class="input-group">
                <div>
                    <label for="keywordInput"><strong>📝 키워드</strong></label>
                    <input type="text" id="keywordInput" placeholder="예: vintage, rare, for parts">
                </div>
                <div>
                    <label for="productNameInput"><strong>🏷️ 제품명</strong></label>
                    <input type="text" id="productNameInput" placeholder="예: Sony Walkman WM-F100II">
                </div>
                <div>
                    <label><strong>📊 데이터 테이블</strong></label>
                    <div class="data-table-input-row">
                        <input type="text" id="dataTableFileName" readonly placeholder="선택된 파일 없음">
                        <button id="dataTableBtn" type="button" onclick="document.getElementById('dataTableInput').click()">업로드</button>
                        <input type="file" id="dataTableInput" accept="image/*" style="display: none;" onchange="handleDataTableImage(this)">
                    </div>
                </div>
            </div>
        </div>
        <div class="step1-right">
            <label for="resultText" style="display: block; margin-bottom: 5px;"><strong>📄 추출된 텍스트</strong></label>
            <div class="progress-bar" id="progressBar"><div class="progress-fill" id="progressFill"></div></div>
            <textarea id="resultText" placeholder="이미지에서 추출된 텍스트가 여기에 순차적으로 나타납니다..."></textarea>
            <div style="margin-top: 10px; text-align: right;">
                <button id="aiGenerateBtn">🚀 시작</button>
            </div>
        </div>
    </div>

</div>

<!-- Step 2: JSON 생성 -->
<div id="step2" class="step-section">
    <h2>Step 2. JSON 생성</h2>
    <label for="jsonInput" style="display: block; margin-bottom: 5px;"><strong>🤖 AI가 생성한 JSON 데이터</strong></label>
    <textarea id="jsonInput" placeholder='AI가 생성한 JSON 결과가 여기에 표시됩니다. 또는 직접 붙여넣고 Step 3을 진행할 수 있습니다.' readonly></textarea>
</div>

<!-- Step 3: 리스팅 생성 -->
<div id="step3" class="step-section">
    <h2>Step 3. 리스팅 생성</h2>
    <div id="outputArea">
        <div class="result-group">
            <span class="result-label">Title Option A <button class="copy-btn" onclick="copyText('titleA')">복사</button></span>
            <input type="text" id="titleA" style="width:100%; padding:8px;" readonly>
        </div>
        <div class="result-group">
            <span class="result-label">Title Option B <button class="copy-btn" onclick="copyText('titleB')">복사</button></span>
            <input type="text" id="titleB" style="width:100%; padding:8px;" readonly>
        </div>
        <div class="result-group">
            <span class="result-label">Item Specifics (Check Only)</span>
            <table id="specsTable"></table>
        </div>
        <div class="result-group">
            <span class="result-label">🔥 HTML Full Code <button class="copy-btn" onclick="copyText('finalHtml')">코드 복사</button></span>
            <textarea id="finalHtml" style="height: 300px; color: #005fbc; font-weight: bold;"></textarea>
        </div>
    </div>
    <button id="resetBtn" onclick="resetAll()">🔄 초기화</button>
</div>

<!-- 설정 모달 -->
<div id="settingsModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>⚙️ 설정</h2>
            <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body">
            <label for="geminiApiKey">🔑 Google Gemini API Key</label>
            <input type="password" id="geminiApiKey" placeholder="API 키를 입력하세요">

            <label for="systemPromptInput">🤖 시스템 프롬프트 (System Prompt)</label>
            <textarea id="systemPromptInput" placeholder="AI에게 내릴 기본 명령어를 입력하세요."></textarea>
            
            <label for="htmlTemplateInput">📜 베이스 HTML 템플릿</label>
            <textarea id="htmlTemplateInput" placeholder="<!-- REPLACE THIS SECTION... --> 주석이 포함된 HTML 코드를 붙여넣으세요."></textarea>
        </div>
        <div class="modal-footer">
            <button id="saveSettingsBtn">저장 후 닫기</button>
        </div>
    </div>
</div>

<div class="footer-info">
    Ver. 2.0 One-Page Flow
</div>

<!-- 포스트잇 메모 -->
<div class="sticky-notes-container">
    <div class="sticky-note">
        <div class="sticky-note-header">📝 메모 1</div>
        <textarea id="memo1" placeholder="메모를 입력하세요..." oninput="localStorage.setItem('memo1', this.value)"></textarea>
    </div>
    <div class="sticky-note">
        <div class="sticky-note-header">📝 메모 2</div>
        <textarea id="memo2" placeholder="메모를 입력하세요..." oninput="localStorage.setItem('memo2', this.value)"></textarea>
    </div>
</div>

<script src="utils.js"></script>
<script src="ocr.js"></script>
<script src="assembler.js"></script>
<script src="ai.js"></script>

</body>
</html>
